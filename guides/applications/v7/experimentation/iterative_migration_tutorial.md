---
title: Iterative Migration Tutorial
---

There are two basic approaches to the iterative migration of a website:

-   **Gradual Roll Out:** This approach gradually shifts traffic for a specific change or improvement from the legacy site to the new site. This gradual approach balances risk with efficiency by allowing you to verify functionality as you switch a feature or a page to the new site. 
-   **Gradual Site Buildout:** This approach shifts all traffic for a specific change or improvement from the legacy site to the new site. This approach is ideal for small changes, vetted changes, or if you value efficiency over an occassional issue. 

This tutorial demonstrates how to gradually roll out new features when migrating a website. This migration involves the following environments:

-   An entry environment through which traffic will be routed.
-   A destination environment to which traffic for the current website will be routed.
-   A destination environment to which traffic for the new website will be routed.

![Dedicated Routing Environment](/images/v7/experimentation-routing-dedicated-environment.png)

## Quick Start

Migrate a website by performing the following steps:

1.  Set up an environment for the current website.
2.  Set up an environment for the new website.
3.  Set up an environment that will split traffic between the above environments.
    1.  Remove all rules.
    2.  Create an origin configuration for each environment to which traffic will be split.
    3.  Create an experiment.
4.  Adjust traffic splitting.
5.  Conclude the experiment

## Assumptions

This tutorial assumes:

-   Your website is already hosted on {{ PRODUCT }}. 
-   You are familiar with the following concepts:
    -   **{{ PORTAL }}:** If you deploy changes through the {{ PORTAL }}, then you should be familiar with the following concepts:
        -   [Properties](/guides/basics/properties) and [environments](/guides/basics/environments).
        -   Setting up [origin configurations](/guides/basics/origins).
        -   [Deploying](/guides/basics/deployments) through the {{ PORTAL }}.
    -   **CDN-as-Code:** If you deploy changes through the {{ PRODUCT }} CLI, then you should be familiar with the:
    -   [{{ CONFIG_FILE }} file](/guides/performance/cdn_as_code/edgio_config)
    -   [{{ ROUTES_FILE }} file](/guides/develop/cli)
    -   [Deploying](/guides/basics/deployments) through the {{ PRODUCT }} CLI. 

## Identifying the Entry Environment

This tutorial requires an environment through which traffic for other environments will be routed. Our recommendation is to use the environment that contains the hostnames for the traffic that will be split. 

<Callout type="info">

  Reusing an environment that contains your hostnames allows for a seamless transition to traffic splitting and simplifies setup.

</Callout>

If traffic splitting will be performed for a domain that has not been previously registered, then you should perform the following steps:
1.  [Create](/guides/basics/environments#creating-an-environment) or identify the entry environment.
2.  [Register the desired hostname(s)](/guides/basics/hostnames#setup).
3.  [Set up TLS for each registered hostname](/guides/basics/hostnames#https-traffic).

## Setting Up the Current Website's Environment

Set up an environment for your current website by performing the following steps:

1.  Create an environment for the current version of your website. 
2.  Replicate the rules and origin configurations defined within the routing environment within this new environment. 
3.  Deploy your changes. 
4.  Test your website using a URL generated by the deployment.

    ![Latest Deployment](/images/v7/experimentation-latest-deployment.png)

## Setting Up the New Website's Environment

Create an environment for the new version of your website. Define rules, origin configurations, or both. Deploy your changes. Test your configuration.

<!--TODO - Specific instructions-->

## Setting Up Origin Configurations

Create an origin configuration for the environment corresponding to the current version of the website. Traffic proxied from the entry environment will be directed to this origin.

Create an origin configuration for the environment corresponding to the new version of the website. Traffic proxied from the entry environment will be directed to this origin.


## Setting Up an Experiment

Create an experiment.

Configure the first variant to set the origin to `current-website`.

![Set Origin Feature](/images/v7/experimentation-cross-env-experiment-set-origin.png)

Configure the second variant to set the origin to `new-website`.

![Set Origin Feature](/images/v7/experimentation-cross-env-experiment-set-origin.png)

Your experiment should look similar to the following illustration:
    
![Cross-Environment Experiment](/images/v7/experimentation-cross-env-experiment.png?width=650)

## Adjusting Traffic Ratio




## Concluding the Experiment